module.exports=function(e,d,l,c,i,m,u){e.get("/Get_User_EmployeeId",function(e,o){try{d.PSQL_getdata('select * from "Admin_M_Users"',function(e,o){})}catch(e){console.log("Error:\tGet_User_EmployeeId"+e)}}),e.post("/SaveUserDetails",function(e,s){try{e.body[0];var o=m.generate({length:8,numbers:!0}),t=l.hashSync(o,u),r=c.generateSecret({name:"Rubus",account:e.body.EmailId}),n='Insert into "Admin_M_Users"("Firstname","MiddelName","Lastname","EmailId","Countrycode","Mobilenumber","EmployeeId","Role","chk_active","Password","SecretId","PasswordPolicy")';n+="values('"+e.body.Firstname+"','"+e.body.MiddelName+"','"+e.body.Lastname+"','"+e.body.EmailId+"','"+e.body.Countrycode+"',"+e.body.Mobilenumber+",'"+e.body.EmployeeId+"','"+e.body.Role+"','"+e.body.chk_active+"','"+t+"','"+r.secret+"','"+e.body.PasswordPolicy+"')";var a="<b>Hi User,</b><br/>";a+="<br/>",a+=" Your password Created SuccessFully....!<br/>",a+="<br/>",a+="<br/>",a+=" User EamilID :"+e.body.EmailId+"<br/>",a+=" Password :"+o+"<br/>",a+=" SecretKey :"+r.secret+"<br/>",a+="<br/>",a+="<br/>",a+="<br/>",a+="Thanks & Regards,<br/>",a+="Envision Enterprise Solutions Pvt Ltd,<br/>",a+="Hyderabad<br/>",i.SendEmail("enterprise360@envisionesl.com",e.body.EmailId,"Rubus App Password",a,function(e,o){e?s.send("User Successfully Created"):d.PSQL_InsertData(n,null,function(e,o){e?(console.log("Error Inserting Data in SaveUserDetails"),s.status(200).json({error:e.message})):s.send("User Successfully Created")})}),s.send({isauthenticated:!1})}catch(e){console.log("Error\tSaveUserDetails"+e)}}),e.get("/User_List",function(e,s){try{d.PSQL_getdata('SELECT amu."Id",amu."EmployeeId",amu."Firstname",amu."Lastname", amu."EmailId",amu."chk_active","Admin_T_Roles"."RoleName","Admin_T_Roles"."RoleId" as "Role"  FROM "Admin_M_Users" as amu INNER JOIN "Admin_T_Roles"  ON CAST (amu."Role" as Integer) = "Admin_T_Roles"."RoleId";',null,function(e,o){e?s.send(!1):s.send(o)})}catch(e){console.log("Error:\tUser_List"+e)}}),e.post("/GetUserData",function(e,s){try{var o=e.body[0],t='select * from "Admin_M_Users"';t+=' where "Id"=',t+="'"+o.id+"'",d.PSQL_getdata(t,null,function(e,o){e?s.send(!1):s.send(o)}),s.send({isauthenticated:!1})}catch(e){s.status(200).json({error:"error at Userupdatedata : "+e.message})}}),e.post("/DeleteUser",function(e,s){try{var o=e.body[0],t='Delete from "Admin_M_Users"';t+=' where "Id"=',t+="'"+o.id+"'",d.PSQL_InsertData(t,null,function(e,o){e?s.send(!1):s.send("User Deleted Successfully")})}catch(e){s.status(200).json({error:"error at Userupdatedata : "+e.message})}}),e.post("/UpdateUser",function(e,s){try{' SET "Countrycode"=$1, "EmailId"=$2,  "Firstname"=$3, "Lastname"=$4, "Mobilenumber"=$5, "Role"=$6, "chk_active"=$7, "EmployeeId"=$8,"PasswordPolicy"=$9 WHERE "Id"=$10';var o=[e.body.Countrycode,e.body.EmailId,e.body.Firstname,e.body.Lastname,e.body.Mobilenumber,e.body.Role,e.body.chk_active,e.body.EmployeeId,e.body.PasswordPolicy,e.body.Id];d.PSQL_InsertData(' UPDATE public."Admin_M_Users" SET "Countrycode"=$1, "EmailId"=$2,  "Firstname"=$3, "Lastname"=$4, "Mobilenumber"=$5, "Role"=$6, "chk_active"=$7, "EmployeeId"=$8,"PasswordPolicy"=$9 WHERE "Id"=$10',o,function(e,o){e?s.send(!1):s.send("User Updated Successfully")})}catch(e){console.log("Error:\tUpdate"+e)}}),e.get("/EmployeeList",function(e,s){try{d.PSQL_getdata('SELECT  "EmpId", "EmpName","Email","MobileNumber" FROM public."Employee_M_Employee";',null,function(e,o){e?s.send(!1):s.send(o)})}catch(e){console.log("ErrorEmployeeList"+e)}}),e.post("/GetEmployeeBasedOnId",function(e,s){try{var o='select * from "Employee_M_Employee"';o+=' where "EmpId"=',o+="'"+e.body.textVal+"'",d.PSQL_getdata(o,null,function(e,o){console.log("response : "+o),e?s.send(!1):s.send(o)})}catch(e){s.status(200).json({error:"error at GetEmployeeData : "+e.message})}}),e.get("/GetRoleAcess",function(e,s){try{d.PSQL_getdata('SELECT * FROM public."Admin_T_Roles";',null,function(e,o){e?s.send(!1):s.send(o)})}catch(e){console.log("Error\tGetRoleAcess"+e)}}),e.get("/GetPassword",function(e,s){try{d.PSQL_getdata(' select * FROM public."Admin_T_PasswordPolicy";',null,function(e,o){e?s.send(!1):s.send(o)})}catch(e){console.log("Error:\t"+e)}}),e.post("/CheckSessionEveryForm",function(e,s){try{d.PSQL_getdata('Select * from "Admin_T_RoleBasedFormAccess" where "RoleId"=$1 and "FormId"=(Select "FormId" from "Admin_T_Forms" where "FormIdText"=$2)',[e.session.RoleId,e.body.FormId],function(e,o){e?s.send({isauthenticated:!0,error:e.message}):s.send({isauthenticated:!0,response:o})})}catch(e){console.log("Error:\tCheckSessionEveryForm"+e)}})};